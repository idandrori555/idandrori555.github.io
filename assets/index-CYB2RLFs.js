(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function o(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=o(n);fetch(n.href,s)}})();const m="1wlT7696OCfC6WwpLQ1LTJ7XkWbu1gEIKEAsXZDaHMak",p={spreadsheet_id:m},{spreadsheet_id:g}=p,h=`https://docs.google.com/spreadsheets/d/${g}/gviz/tq?tqx=out:csv`,D="No data found in the spreadsheet",E="אין שיעור",S="שגיאה",L=()=>{const t=new Date,e=String(t.getDate()).padStart(2,"0"),o=String(t.getMonth()+1).padStart(2,"0");return`${e}/${o}`};function I(t,e){return e.findIndex(o=>o.includes(t))}async function v(t=L()){try{const e=await fetch(h);if(!e.ok)throw new Error(`Failed to fetch data: ${e.status} ${e.statusText}`);const r=(await e.text()).split(`
`).map(s=>s.split(","));if(!r||r.length<=1)return D;const n=r.find(s=>s.toString().includes(t));if(n){const s=I(t,n);return(n[s+1]??S).split('"').join("")}return E}catch(e){return console.error("Error fetching or processing the spreadsheet data:",e),"An error occurred while processing the data."}}document.addEventListener("DOMContentLoaded",()=>{w(),A(),f(u())});function l(){return{searchForm:document.getElementById("search-form"),lessonDateInput:document.getElementById("lesson-date"),loader:document.getElementById("loader"),frontalLesson:document.getElementById("frontal-lesson"),virtualLesson:document.getElementById("virtual-lesson"),noLesson:document.getElementById("no-lesson"),errorMessage:document.getElementById("error-message"),dateDisplays:{frontal:document.getElementById("frontal-date"),virtual:document.getElementById("virtual-date"),none:document.getElementById("no-lesson-date")}}}function u(){const t=new Date,e=String(t.getDate()).padStart(2,"0"),o=String(t.getMonth()+1).padStart(2,"0");return`${t.getFullYear()}-${o}-${e}`}function w(){const{lessonDateInput:t}=l();t.value=u()}function A(){const{searchForm:t,lessonDateInput:e}=l();t.addEventListener("submit",o=>{o.preventDefault();const r=e.value;if(!r){d("נא לבחור תאריך");return}f(r)})}function M(){const{loader:t,frontalLesson:e,virtualLesson:o,noLesson:r,errorMessage:n}=l();t.style.display="block",e.style.display="none",o.style.display="none",r.style.display="none",n.style.display="none"}function d(t){const{loader:e,errorMessage:o}=l();e.style.display="none",o.textContent=t,o.style.display="block"}function O(t){return new Date(t)}function $(t){const e=String(t.getDate()).padStart(2,"0"),o=String(t.getMonth()+1).padStart(2,"0");return`${e}/${o}`}function b(t){const e=t.getDate(),r=["ינואר","פברואר","מרץ","אפריל","מאי","יוני","יולי","אוגוסט","ספטמבר","אוקטובר","נובמבר","דצמבר"][t.getMonth()],n=t.getFullYear();return`${e} ב${r}, ${n}`}function f(t){const{loader:e,dateDisplays:o,frontalLesson:r,virtualLesson:n,noLesson:s}=l(),a=O(t);if(isNaN(a.getTime())){d("תאריך לא חוקי");return}M();const y=$(a),i=b(a);v(y).then(c=>{if(e.style.display="none",o.frontal.textContent=i,o.virtual.textContent=i,o.none.textContent=i,c==="פרונטלי")r.style.display="block";else if(c==="וירטואלי")n.style.display="block";else if(c==="אין שיעור")s.style.display="block";else throw new Error("Unexpected lesson type from API")}).catch(c=>{console.error("API error:",c),d("אירעה שגיאה בעת טעינת נתוני השיעור. אנא נסה שוב.")})}
